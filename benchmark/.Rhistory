v <- c(specie_counts[2:length(names(specie_counts))])
ggplot() + aes(v) + geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
i
specie_counts
specie_counts.summerise
specie_counts.count()
spec.ar()
specie_counts
sum(is.na(specie_counts))
sapply(specie_counts, function(x) sum(is.na(x)))
specie_counts
specie_counts$n_lib
length(specie_counts)
dim(specie_counts)
names(specie_counts)
r <- sapply(specie_counts, function(x) sum(is.na(x)))
rr = dim(specie_counts)[1]
rr
r ==rr
count_nans <- sapply(specie_counts, function(x) sum(is.na(x)))
typeof(couunt_nans)
typeof(count_nans)
count_nans[1]
r !=rr
r[r !=rr]
names(r[r !=rr])
r==r
rr
specie_counts <- tissue_counts_int[which (tissue_counts_int$Species==i), names(tissue_counts_int) %in% c(names(tissue_counts_int)[2:length(names(tissue_counts_int))])]
specie_counts
count_nans <- sapply(specie_counts, function(x) sum(is.na(x)))
count_nans
expressed_tissues <-names(count_nans[count_nans !=dim(specie_counts)[1]])
expressed_tissues
expressed_tissues <- expressed_tissues[2:length(expressed_tissues)]
expressed_tissues
v <- c(specie_counts[expressed_tissues])
v
ggplot() + aes(v) + geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
ggplot() + aes(specie_counts[expressed_tissues]) + geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
help("ggplot")
help(aes)
ggplot() + aes(specie_counts$testis) + geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
specie_counts$testis
ggplot() + aes(specie_counts$testis) + geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
ggplot() + aes(x=specie_counts$testis) + geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
ggplot() + mapping=aes(x=specie_counts$testis) + geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
ggplot( mapping=aes(x=specie_counts$testis)) + geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
for (i in species){
print(i)
specie_counts <- tissue_counts_int[which (tissue_counts_int$Species==i), names(tissue_counts_int) %in% c(names(tissue_counts_int)[2:length(names(tissue_counts_int))])]
count_nans <- sapply(specie_counts, function(x) sum(is.na(x)))
expressed_tissues <-names(count_nans[count_nans !=dim(specie_counts)[1]])
expressed_tissues <- expressed_tissues[2:length(expressed_tissues)]
v <- c(specie_counts[expressed_tissues])
v
ggplot( mapping=aes(x=specie_counts$testis)) + geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
}
ggplot( mapping=aes(x=v)) + geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
specie_counts$testis$testis
specie_counts$testis
ggplot(aes(x=specie_counts$testis)+geom_histogram()
ef
ggplot(aes(x=specie_counts$testis))+geom_histogram()
ggplot(specie_counts,aes(x=specie_counts$testis))+geom_histogram()
sum_counts <- aggregate(tissue_counts_int[9:dim(tissue_counts_int)[2]], by=list(tissue_counts_int$Species), FUN=sum,na.rm = TRUE)
sum_counts
colnames(sum_counts)[1] <- "Species"
specie_counts <- sum_counts[which (sum_counts$Species==i), names(sum_counts) %in% c(names(sum_counts))]
specie_counts
count_nans <- sapply(specie_counts, function(x) x==0)
count_nans
count_zeros <- sapply(specie_counts, function(x) x==0)
expressed_tissues <-names(count_zeros[not count_zeros])
expressed_tissues <-names(count_zeros[!count_zeros])
expressed_tissues
count_zeros <- sapply(specie_counts, function(x) x==0)
count_zeros
v <- c(specie_counts[expressed_tissues])
v
ggplot( mapping=aes(x=v)) + geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
ggplot(specie_counts, mapping=aes(x=v)) + geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
ggplot(specie_counts[expressed_tissues], aes(x=expressed_tissues))+geom_histogram(stat="identity",position="dodge")
for (i in species){
print(i)
specie_counts <- tissue_counts_int[which (tissue_counts_int$Species==i), names(tissue_counts_int) %in% c(names(tissue_counts_int)[2:length(names(tissue_counts_int))])]
count_nans <- sapply(specie_counts, function(x) sum(is.na(x)))
expressed_tissues <-names(count_nans[count_nans !=dim(specie_counts)[1]])
expressed_tissues <- expressed_tissues[2:length(expressed_tissues)]
v <- c(specie_counts[expressed_tissues])
ggplot(specie_counts[expressed_tissues], aes(x=expressed_tissues))+geom_histogram(stat="identity",position="dodge")
}
ggplot()+aes(v)+geom_histogram(binwidth = (0.01))+xlim(c(-0.1,0.1))+labs(x="Jahresuberschuss",y="count")
?aes
stof
?stof
?STOF
#ggplot( mapping=aes(x=expressed_tissues,y = )) + geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
library(reshape2)
specie_counts
i
t(specie_counts)
(specie_counts[expressed_tissues]
dc
specie_counts[expressed_tissues]
t(specie_counts[expressed_tissues])
specie_counts
names(specie_counts)
new.df<-melt(specie_counts,id.vars=names(specie_counts[expressed_tissues]))
new.df
specie_counts[expressed_tissues]
new.df<-melt(specie_counts[expressed_tissues],id.vars=names(specie_counts[expressed_tissues]))
new.df
ggplot(specie_counts[expressed_tissues], aes(x=specie_counts$testis))+geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
ggplot(aes(x=specie_counts$testis))+geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
ggplot()aes(x=specie_counts$testis))+geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
for (i in species){
print(i)
specie_counts <- tissue_counts_int[which (tissue_counts_int$Species==i), names(tissue_counts_int) %in% c(names(tissue_counts_int)[2:length(names(tissue_counts_int))])]
count_nans <- sapply(specie_counts, function(x) sum(is.na(x)))
expressed_tissues <-names(count_nans[count_nans !=dim(specie_counts)[1]])
expressed_tissues <- expressed_tissues[2:length(expressed_tissues)]
v <- c(specie_counts[expressed_tissues])
ggplot(specie_counts[expressed_tissues], aes(x=specie_counts$testis))+geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
}
ggplot(specie_counts[expressed_tissues], mapping = aes(x=specie_counts$testis))+geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
for (i in species){
print(i)
specie_counts <- tissue_counts_int[which (tissue_counts_int$Species==i), names(tissue_counts_int) %in% c(names(tissue_counts_int)[2:length(names(tissue_counts_int))])]
count_nans <- sapply(specie_counts, function(x) sum(is.na(x)))
expressed_tissues <-names(count_nans[count_nans !=dim(specie_counts)[1]])
expressed_tissues <- expressed_tissues[2:length(expressed_tissues)]
v <- c(specie_counts[expressed_tissues])
ggplot(specie_counts[expressed_tissues], mapping = aes(x=specie_counts$testis))+geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
}
ggplot()aes(x=specie_counts$testis))+geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
ggplot(aes(x=specie_counts$testis))+geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
ggplot(specie_counts[expressed_tissues], aes(x=specie_counts$testis))+geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
ggplot(specie_counts[expressed_tissues], mapping = aes(x=specie_counts$testis))+geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
#ggplot( mapping=aes(x=expressed_tissues,y = )) + geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
library(reshape2)
ggplot(aes(x=specie_counts$testis))+geom_histogram()
ggplot(specie_counts[expressed_tissues], aes(x=expressed_tissues))+geom_histogram(stat="identity",position="dodge")
ggplot(specie_counts[expressed_tissues], aes(x=expressed_tissues))+geom_histogram()
ggplot(specie_counts[expressed_tissues], aes(x=specie_counts$testis))+geom_histogram()
expressed_tissues
ggplot(specie_counts[expressed_tissues], aes(x=specie_counts$brain))+geom_histogram()
tissue_counts
colSums(!is.na(tissue_counts))
colSums(!is.na(specie_counts))
t <-colSums(!is.na(specie_counts[expressed_tissues]))
t
ggplot(specie_counts[expressed_tissues], mapping = aes(x=t))+geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
ggplot( mapping = aes(x=t))+geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
specie_counts[expressed_tissues]
new.df<-melt(specie_counts[expressed_tissues],id.vars=t))
new.df<-melt(specie_counts[expressed_tissues],id.vars=t)
t
file = '/home/sofya/Documents/TranscriptAnnotation/benchmark/PAX6/Ensembl/counts.tsv'
tissue_counts <- read.table(file, header = TRUE, sep = "\t", col.names = c('TranscriptIDCluster_5p', 'ExonIDCluster_5p', 'HomologousExon_5p', 'TranscriptIDCluster_3p', 'ExonIDCluster_3p', 'HomologousExon_3p', 'Species', 'n_lib', "Ammon's_horn", 'CD4-positive_helper_T_cell', 'adipose_tissue', 'adrenal_gland', 'adrenal_tissue', 'adult_mammalian_kidney', 'adult_organism', 'blastula', 'bone_marrow', 'bone_marrow_macrophage', 'bone_tissue', 'brain', 'brown_adipose_tissue', 'cerebellum', 'cerebral_cortex', 'colon', 'corpus_callosum', 'egg_cell', 'embryo', 'embryonic_stem_cell', 'eye', 'female_gonad', 'female_reproductive_system', 'fibroblast', 'frontal_cortex', 'gastrula', 'head', 'head_kidney', 'heart', 'heart_left_ventricle', 'intestine', 'kidney', 'larva', 'leukocyte', 'liver', 'lung', 'lymph_node', 'male_reproductive_system', 'mature_ovarian_follicle', 'mesonephros', 'multi-cellular_organism', 'multi-tissue_structure', 'muscle_of_leg', 'muscle_tissue', 'peripheral_blood_mononuclear_cell', 'pharyngeal_gill', 'pharyngeal_muscle_cell_(C_elegans)', 'placenta', 'prefrontal_cortex', 'prostate_gland', 'rectum', 'skeletal_muscle_tissue', 'spleen', 'stomach', 'tail', 'temporal_lobe', 'testis', 'thoracic_mammary_gland', 'thymus', 'thyroid_gland', 'zone_of_skin'))
tissue_counts <- read.table(file, header = TRUE, sep = "\t", col.names = c('TranscriptIDCluster_5p', 'ExonIDCluster_5p', 'HomologousExon_5p', 'TranscriptIDCluster_3p', 'ExonIDCluster_3p', 'HomologousExon_3p', 'Species', "Ammon's_horn", 'CD4-positive_helper_T_cell', 'adipose_tissue', 'adrenal_gland', 'adrenal_tissue', 'adult_mammalian_kidney', 'adult_organism', 'blastula', 'bone_marrow', 'bone_marrow_macrophage', 'bone_tissue', 'brain', 'brown_adipose_tissue', 'cerebellum', 'cerebral_cortex', 'colon', 'corpus_callosum', 'egg_cell', 'embryo', 'embryonic_stem_cell', 'eye', 'female_gonad', 'female_reproductive_system', 'fibroblast', 'frontal_cortex', 'gastrula', 'head', 'head_kidney', 'heart', 'heart_left_ventricle', 'intestine', 'kidney', 'larva', 'leukocyte', 'liver', 'lung', 'lymph_node', 'male_reproductive_system', 'mature_ovarian_follicle', 'mesonephros', 'multi-cellular_organism', 'multi-tissue_structure', 'muscle_of_leg', 'muscle_tissue', 'peripheral_blood_mononuclear_cell', 'pharyngeal_gill', 'pharyngeal_muscle_cell_(C_elegans)', 'placenta', 'prefrontal_cortex', 'prostate_gland', 'rectum', 'skeletal_muscle_tissue', 'spleen', 'stomach', 'tail', 'temporal_lobe', 'testis', 'thoracic_mammary_gland', 'thymus', 'thyroid_gland', 'zone_of_skin'))
tissue_counts <- data.frame(tissue_counts, check.names = TRUE)
species <- unique(tissue_counts$Species)
tissue_counts_int <- tissue_counts[7:dim(tissue_counts)[2]]
tissue_counts
tissue_counts_int
i = 'homo_sapiens'
specie_counts <- tissue_counts_int[which (tissue_counts_int$Species==i), names(tissue_counts_int) %in% c(names(tissue_counts_int)[2:length(names(tissue_counts_int))])]
specie_counts
count_nans <- sapply(specie_counts, function(x) sum(is.na(x)))
expressed_tissues <-names(count_nans[count_nans !=dim(specie_counts)[1]])
expressed_tissues <- expressed_tissues[2:length(expressed_tissues)]
t <-colSums(!is.na(specie_counts[expressed_tissues]))
t
t
names(t)
ggplot(t,aes(x = names(t),y=t))+geom_bar(stat="identity")+labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
names()data.frame(t)
data.frame(t)
names(t)
ggplot(data.frame(t),aes(x = names(t),y=t))+geom_bar(stat="identity")+labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
row.names(t)
e=data.frame(t)
e
names(e)
row.names(e)
ggplot(data.frame(t),aes(x = row.names(data.frame(t)),y=data.frame(t)))+geom_bar(stat="identity")+labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
t
t[3]
data.frame(t)
df <-data.frame(t)
df
df$tissue <- rownames(df)
df
ggplot(df,aes(x = df$tissue,y=df$t))+geom_bar(stat="identity")+labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
help(labs)
ggplot(df,aes(x = df$tissue,y=df$t))+geom_bar(stat="identity")+labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))+theme(axis.text.x = element_text(angle = 90, hjust = 1))
for (i in species){
print(i)
specie_counts <- tissue_counts_int[which (tissue_counts_int$Species==i), names(tissue_counts_int) %in% c(names(tissue_counts_int)[2:length(names(tissue_counts_int))])]
count_nans <- sapply(specie_counts, function(x) sum(is.na(x)))
expressed_tissues <-names(count_nans[count_nans !=dim(specie_counts)[1]])
expressed_tissues <- expressed_tissues[2:length(expressed_tissues)]
t <-colSums(!is.na(specie_counts[expressed_tissues]))
df <-data.frame(t)
df$tissue <- rownames(df)
ggplot(df,aes(x = df$tissue,y=df$t))+geom_bar(stat="identity")+labs(x='tissue',y = 'counts')+ggtitle(paste('Total count of unique reads ',i,sep = ' '))+theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(specie_counts[expressed_tissues], mapping = aes(x=t))+geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
}
for (i in species){
print(i)
specie_counts <- tissue_counts_int[which (tissue_counts_int$Species==i), names(tissue_counts_int) %in% c(names(tissue_counts_int)[2:length(names(tissue_counts_int))])]
count_nans <- sapply(specie_counts, function(x) sum(is.na(x)))
expressed_tissues <-names(count_nans[count_nans !=dim(specie_counts)[1]])
expressed_tissues <- expressed_tissues[2:length(expressed_tissues)]
t <-colSums(!is.na(specie_counts[expressed_tissues]))
df <-data.frame(t)
df$tissue <- rownames(df)
ggplot(df,aes(x = df$tissue,y=df$t))+geom_bar(stat="identity")+labs(x='tissue',y = 'counts')+ggtitle(paste('Total count of unique reads ',i,sep = ' '))+theme(axis.text.x = element_text(angle = 90, hjust = 1))
#ggplot(specie_counts[expressed_tissues], mapping = aes(x=t))+geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
}
for (i in species){
print(i)
specie_counts <- tissue_counts_int[which (tissue_counts_int$Species==i), names(tissue_counts_int) %in% c(names(tissue_counts_int)[2:length(names(tissue_counts_int))])]
count_nans <- sapply(specie_counts, function(x) sum(is.na(x)))
expressed_tissues <-names(count_nans[count_nans !=dim(specie_counts)[1]])
expressed_tissues <- expressed_tissues[2:length(expressed_tissues)]
t <-colSums(!is.na(specie_counts[expressed_tissues]))
df <-data.frame(t)
df$tissue <- rownames(df)
ggplot(df,aes(x = df$tissue,y=df$t))+geom_bar(stat="identity")+labs(x='tissue',y = 'counts')+ggtitle(paste('Total count of unique reads ',i,sep = ' '))+theme(axis.text.x = element_text(angle = 90, hjust = 1))
#ggplot(specie_counts[expressed_tissues], mapping = aes(x=t))+geom_histogram((binwidth = 0.01))+ labs(x='tissue',y = 'counts')+ggtitle(paste('Histogram of notmalized tissue specific counts in',i,sep = ' '))
}
for (i in species){
print(i)
specie_counts <- tissue_counts_int[which (tissue_counts_int$Species==i), names(tissue_counts_int) %in% c(names(tissue_counts_int)[2:length(names(tissue_counts_int))])]
count_nans <- sapply(specie_counts, function(x) sum(is.na(x)))
expressed_tissues <-names(count_nans[count_nans !=dim(specie_counts)[1]])
expressed_tissues <- expressed_tissues[2:length(expressed_tissues)]
t <-colSums(!is.na(specie_counts[expressed_tissues]))
df <-data.frame(t)
df$tissue <- rownames(df)
ggplot(df,aes(x = df$tissue,y=df$t))+geom_bar(stat="identity")+labs(x='tissue',y = 'counts')+ggtitle(paste('Total count of unique reads ',i,sep = ' '))+theme(axis.text.x = element_text(angle = 90, hjust = 1))
}
species <- unique(tissue_counts$Species)
tissue_counts_int <- tissue_counts[7:dim(tissue_counts)[2]]
for (i in species){
print(i)
specie_counts <- tissue_counts_int[which (tissue_counts_int$Species==i), names(tissue_counts_int) %in% c(names(tissue_counts_int)[2:length(names(tissue_counts_int))])]
count_nans <- sapply(specie_counts, function(x) sum(is.na(x)))
expressed_tissues <-names(count_nans[count_nans !=dim(specie_counts)[1]])
expressed_tissues <- expressed_tissues[2:length(expressed_tissues)]
t <-colSums(!is.na(specie_counts[expressed_tissues]))
df <-data.frame(t)
df$tissue <- rownames(df)
ggplot(df,aes(x = df$tissue,y=df$t))+geom_bar(stat="identity")+labs(x='tissue',y = 'counts')+ggtitle(paste('Total count of unique reads ',i,sep = ' '))+theme(axis.text.x = element_text(angle = 90, hjust = 1))
}
species
for i in species(print(i))
for (i in species){print(i)}
i = "bos_taurus"
specie_counts <- tissue_counts_int[which (tissue_counts_int$Species==i), names(tissue_counts_int) %in% c(names(tissue_counts_int)[2:length(names(tissue_counts_int))])]
count_nans <- sapply(specie_counts, function(x) sum(is.na(x)))
expressed_tissues <-names(count_nans[count_nans !=dim(specie_counts)[1]])
expressed_tissues <- expressed_tissues[2:length(expressed_tissues)]
t <-colSums(!is.na(specie_counts[expressed_tissues]))
df <-data.frame(t)
df$tissue <- rownames(df)
df
ggplot(df,aes(x = df$tissue,y=df$t))+geom_bar(stat="identity")+labs(x='tissue',y = 'counts')+ggtitle(paste('Total count of unique reads ',i,sep = ' '))+theme(axis.text.x = element_text(angle = 90, hjust = 1))
i = 'gorilla_gorilla'
specie_counts <- tissue_counts_int[which (tissue_counts_int$Species==i), names(tissue_counts_int) %in% c(names(tissue_counts_int)[2:length(names(tissue_counts_int))])]
count_nans <- sapply(specie_counts, function(x) sum(is.na(x)))
expressed_tissues <-names(count_nans[count_nans !=dim(specie_counts)[1]])
expressed_tissues <- expressed_tissues[2:length(expressed_tissues)]
t <-colSums(!is.na(specie_counts[expressed_tissues]))
df <-data.frame(t)
df$tissue <- rownames(df)
df
ggplot(df,aes(x = df$tissue,y=df$t))+geom_bar(stat="identity")+labs(x='tissue',y = 'counts')+ggtitle(paste('Total count of unique reads ',i,sep = ' '))+theme(axis.text.x = element_text(angle = 90, hjust = 1))
i ='macaca_mulatta'
specie_counts <- tissue_counts_int[which (tissue_counts_int$Species==i), names(tissue_counts_int) %in% c(names(tissue_counts_int)[2:length(names(tissue_counts_int))])]
count_nans <- sapply(specie_counts, function(x) sum(is.na(x)))
expressed_tissues <-names(count_nans[count_nans !=dim(specie_counts)[1]])
expressed_tissues <- expressed_tissues[2:length(expressed_tissues)]
t <-colSums(!is.na(specie_counts[expressed_tissues]))
df <-data.frame(t)
df$tissue <- rownames(df)
df
ggplot(df,aes(x = df$tissue,y=df$t))+geom_bar(stat="identity")+labs(x='tissue',y = 'counts')+ggtitle(paste('Total count of unique reads ',i,sep = ' '))+theme(axis.text.x = element_text(angle = 90, hjust = 1))
i='ornithorhynchus_anatinus'
specie_counts <- tissue_counts_int[which (tissue_counts_int$Species==i), names(tissue_counts_int) %in% c(names(tissue_counts_int)[2:length(names(tissue_counts_int))])]
count_nans <- sapply(specie_counts, function(x) sum(is.na(x)))
expressed_tissues <-names(count_nans[count_nans !=dim(specie_counts)[1]])
expressed_tissues <- expressed_tissues[2:length(expressed_tissues)]
t <-colSums(!is.na(specie_counts[expressed_tissues]))
df <-data.frame(t)
df$tissue <- rownames(df)
df
ggplot(df,aes(x = df$tissue,y=df$t))+geom_bar(stat="identity")+labs(x='tissue',y = 'counts')+ggtitle(paste('Total count of unique reads ',i,sep = ' '))+theme(axis.text.x = element_text(angle = 90, hjust = 1))
i='rattus_norvegicus'
specie_counts <- tissue_counts_int[which (tissue_counts_int$Species==i), names(tissue_counts_int) %in% c(names(tissue_counts_int)[2:length(names(tissue_counts_int))])]
count_nans <- sapply(specie_counts, function(x) sum(is.na(x)))
expressed_tissues <-names(count_nans[count_nans !=dim(specie_counts)[1]])
expressed_tissues <- expressed_tissues[2:length(expressed_tissues)]
t <-colSums(!is.na(specie_counts[expressed_tissues]))
df <-data.frame(t)
df$tissue <- rownames(df)
df
ggplot(df,aes(x = df$tissue,y=df$t))+geom_bar(stat="identity")+labs(x='tissue',y = 'counts')+ggtitle(paste('Total count of unique reads ',i,sep = ' '))+theme(axis.text.x = element_text(angle = 90, hjust = 1))
i='xenopus_tropicalis'
specie_counts <- tissue_counts_int[which (tissue_counts_int$Species==i), names(tissue_counts_int) %in% c(names(tissue_counts_int)[2:length(names(tissue_counts_int))])]
count_nans <- sapply(specie_counts, function(x) sum(is.na(x)))
expressed_tissues <-names(count_nans[count_nans !=dim(specie_counts)[1]])
expressed_tissues <- expressed_tissues[2:length(expressed_tissues)]
t <-colSums(!is.na(specie_counts[expressed_tissues]))
df <-data.frame(t)
df$tissue <- rownames(df)
df
ggplot(df,aes(x = df$tissue,y=df$t))+geom_bar(stat="identity")+labs(x='tissue',y = 'counts')+ggtitle(paste('Total count of unique reads ',i,sep = ' '))+theme(axis.text.x = element_text(angle = 90, hjust = 1))
i='sus_scrofa'
specie_counts <- tissue_counts_int[which (tissue_counts_int$Species==i), names(tissue_counts_int) %in% c(names(tissue_counts_int)[2:length(names(tissue_counts_int))])]
count_nans <- sapply(specie_counts, function(x) sum(is.na(x)))
expressed_tissues <-names(count_nans[count_nans !=dim(specie_counts)[1]])
expressed_tissues <- expressed_tissues[2:length(expressed_tissues)]
t <-colSums(!is.na(specie_counts[expressed_tissues]))
df <-data.frame(t)
df$tissue <- rownames(df)
df
expressed_tissues <- expressed_tissues[2:length(expressed_tissues)]
expressed_tissues
t <-colSums(!is.na(specie_counts[expressed_tissues]))
t
df <-data.frame(t)
df
ggplot(df,aes(x = df$tissue,y=df$t))+geom_bar(stat="identity")+labs(x='tissue',y = 'counts')+ggtitle(paste('Total count of unique reads ',i,sep = ' '))+theme(axis.text.x = element_text(angle = 90, hjust = 1))
source('~/Documents/TranscriptAnnotation/rnaseq/code/splice_graph_benchmark.R')
library(RCy3)
source('~/Documents/TranscriptAnnotation/rnaseq/code/splice_graph_benchmark.R')
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("RCy3")
source('~/Documents/TranscriptAnnotation/rnaseq/code/splice_graph_benchmark.R')
install.packages("tidyverse")
install.packages("dplyr")
install.packages("dplyr")
install.packages("data.table")
install.packages("ggplot2")
library(ggplot2)
library(tidyr)
library(dplyr)
library(data.table)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("RCy3")
source('~/Documents/TranscriptAnnotation/rnaseq/code/splice_graph_benchmark.R')
proteins <-
read.delim("/home/sofya/Documents/TranscriptAnnotation/benchmark_list.txt",
header = FALSE)
proteproc.time()
proteins
proteins <- as.character(proteins$V1)
proteins
for (protein in proteins) {
network_file <-
paste(
"/home/sofya/Documents/TranscriptAnnotation/benchmark/",
protein,
"/thoraxe/splice_graph.gml",
sep = ""
)
if (file.exists(network_file)) {
pdf_file <-
paste(
"/home/sofya/Documents/TranscriptAnnotation/benchmark/",
protein,
"Ensembl/plots/splice_graph.pdf",
sep = ""
)
session_file <-
paste(
"/home/sofya/Documents/TranscriptAnnotation/benchmark/",
protein,
"/CytoscapeSession.cys",
sep = ""
)
cat(paste(network_file, "\n"))
importNetworkFromFile(network_file)
cat("    ...imported!\n")
sty <- importVisualStyles(style_file)
setVisualStyle(sty)
cat("    ...style applied!\n")
layoutNetwork("hierarchical")
cat("    ...layout applied!\n")
exportImage(pdf_file, type = "PDF")
cat("    ...pdf saved!\n")
saveSession(session_file)
cat("    ...session saved!\n")
deleteAllNetworks()
}
}
proteins
source('~/Documents/TranscriptAnnotation/rnaseq/code/splice_graph_benchmark.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/splice_graph_benchmark.R')
protein = 'PAX6'
network_file <-
paste(
"/home/sofya/Documents/TranscriptAnnotation/benchmark/",
protein,
"/thoraxe/splice_graph.gml",
sep = ""
)
network_file
(file.exists(network_file))
source('~/Documents/TranscriptAnnotation/rnaseq/code/splice_graph_benchmark.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/splice_graph_benchmark.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/splice_graph_benchmark.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/splice_graph_benchmark.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/splice_graph_benchmark.R')
proteins
proteins <- subset(proteins, -c(GRIN1))
proteins.remove('GRIN1')
proteins[29]
proteins[1:28,30:51]
c(proteins[1:28],proteins[30:51])
source('~/Documents/TranscriptAnnotation/rnaseq/code/splice_graph_benchmark.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/splice_graph_benchmark.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/splice_graph_benchmark.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/splice_graph_benchmark.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/splice_graph_benchmark.R')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
proteins
proteins <-proteins[15:length(proteins)]
proteins
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
proteins
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_rnaseq_splice_graph_.R')
proteins
proteins[30]
proteins[34]
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_rnaseq_splice_graph_.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_rnaseq_splice_graph_.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_rnaseq_splice_graph_.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
proteins
proteins[20]
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
proteins
proteins <- c(proteins[1:28],proteins[30:51])#NoGRIN1
proteins
proteins <-
read.delim("/home/sofya/Documents/TranscriptAnnotation/benchmark_list.txt",
header = FALSE)
proteins <- as.character(proteins$V1)
proteins <- c(proteins[1:28],proteins[30:51])#NoGRIN1
proteins
proteins[30]
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
proteins <-
read.delim("/home/sofya/Documents/TranscriptAnnotation/benchmark_list.txt",
header = FALSE)
proteins <- as.character(proteins$V1)
proteins <- c(proteins[1:28],proteins[30:51])#NoGRIN1
proteins <- proteins[34:length(proteins)]
proteins
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
proteins
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
proteins
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
proteins
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_splice_graph.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_rnaseq_splice_graph_.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
proteins
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
proteins
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
proteins
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
proteins
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
proteins
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
proteins
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/plot_both_splice_graphs.R')
source('~/Documents/TranscriptAnnotation/rnaseq/code/count_hist.R')
